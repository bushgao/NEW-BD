# 平台管理端 - 阶段3用户管理功能测试指南

**创建时间**: 2026年1月6日  
**功能**: 用户管理  
**测试账号**: admin@example.com / admin123

---

## 📋 测试前准备

1. 确保后端服务运行：`http://localhost:3000`
2. 确保前端服务运行：`http://localhost:5173`
3. 确保数据库迁移已完成（添加了isActive等字段）
4. 使用平台管理员账号登录

---

## ✅ 测试步骤

### 1. 菜单导航测试

**操作**：
1. 登录后查看左侧菜单
2. 应该看到4个菜单项：
   - 📊 数据概览
   - 🏭 工厂管理
   - 👥 达人管理
   - 👤 用户管理 ✨ 新增

**预期结果**：
- ✅ 菜单显示正常
- ✅ "用户管理"菜单项存在
- ✅ 图标为用户图标

---

### 2. 用户列表查看

**操作**：
1. 点击左侧菜单"用户管理"
2. 查看用户列表页面

**预期结果**：
- ✅ 页面正常加载
- ✅ 显示用户列表表格
- ✅ 表格包含以下列：
  - 姓名
  - 邮箱
  - 角色（带颜色标签）
  - 所属工厂
  - 状态（启用/禁用）
  - 注册时间
  - 最后登录
  - 操作（详情、启用/禁用按钮）
- ✅ 显示分页器
- ✅ 显示总用户数

---

### 3. 搜索功能测试

**操作**：
1. 在搜索框输入用户姓名（如"张"）
2. 点击搜索按钮
3. 清空搜索框，输入邮箱（如"@example.com"）
4. 再次搜索

**预期结果**：
- ✅ 搜索结果正确过滤
- ✅ 支持姓名搜索
- ✅ 支持邮箱搜索
- ✅ 清空搜索后恢复全部列表

---

### 4. 角色筛选测试

**操作**：
1. 点击"角色筛选"下拉框
2. 选择"平台管理员"
3. 查看筛选结果
4. 选择"工厂老板"
5. 查看筛选结果
6. 选择"商务人员"
7. 查看筛选结果
8. 清空筛选

**预期结果**：
- ✅ 筛选结果正确
- ✅ 只显示对应角色的用户
- ✅ 清空后恢复全部列表

---

### 5. 状态筛选测试

**操作**：
1. 点击"状态筛选"下拉框
2. 选择"启用"
3. 查看筛选结果
4. 选择"禁用"
5. 查看筛选结果（如果有禁用用户）
6. 清空筛选

**预期结果**：
- ✅ 筛选结果正确
- ✅ 只显示对应状态的用户
- ✅ 状态标签颜色正确（启用=绿色，禁用=红色）

---

### 6. 用户详情查看（工厂老板）

**操作**：
1. 找到一个角色为"工厂老板"的用户
2. 点击"详情"按钮
3. 查看弹窗内容

**预期结果**：
- ✅ 弹窗正常打开
- ✅ 显示4个标签页
- ✅ "基本信息"标签页显示：
  - 姓名、邮箱
  - 角色（工厂老板）
  - 所属工厂名称
  - 账号状态
  - 注册时间
  - 最后登录时间
- ✅ "工作数据"标签页显示：
  - "该角色无工作数据统计"提示
- ✅ "达人列表"和"合作列表"标签页显示：
  - "该角色无达人/合作数据"提示

---

### 7. 用户详情查看（商务人员）

**操作**：
1. 找到一个角色为"商务人员"的用户
2. 点击"详情"按钮
3. 查看"基本信息"标签页
4. 切换到"工作数据"标签页
5. 切换到"达人列表"标签页
6. 切换到"合作列表"标签页

**预期结果**：
- ✅ "基本信息"正常显示
- ✅ "工作数据"显示统计卡片：
  - 添加达人数（带图标）
  - 创建合作数（带图标）
  - 完成合作数（带图标）
  - 成功率（百分比）
- ✅ "达人列表"显示表格：
  - 达人名称
  - 平台
  - 粉丝数
  - 添加时间
  - 支持分页
- ✅ "合作列表"显示表格：
  - 达人名称
  - 状态（带颜色标签）
  - 创建时间
  - 完成时间
  - 支持分页

---

### 8. 禁用用户测试

**操作**：
1. 找到一个"商务人员"用户（不是自己）
2. 点击"禁用"按钮
3. 确认操作
4. 查看用户状态变化

**预期结果**：
- ✅ 显示成功提示："用户已禁用"
- ✅ 用户状态标签变为"禁用"（红色）
- ✅ 操作按钮变为"启用"
- ✅ 列表自动刷新

---

### 9. 启用用户测试

**操作**：
1. 找到刚才禁用的用户
2. 点击"启用"按钮
3. 确认操作
4. 查看用户状态变化

**预期结果**：
- ✅ 显示成功提示："用户已启用"
- ✅ 用户状态标签变为"启用"（绿色）
- ✅ 操作按钮变为"禁用"
- ✅ 列表自动刷新

---

### 10. 安全保护测试

**测试1：禁用平台管理员**
**操作**：
1. 找到一个"平台管理员"用户
2. 尝试点击"禁用"按钮

**预期结果**：
- ✅ 显示错误提示："不能禁用平台管理员账号"
- ✅ 用户状态未改变

**测试2：禁用自己**
**操作**：
1. 找到当前登录的管理员账号
2. 尝试点击"禁用"按钮

**预期结果**：
- ✅ 显示错误提示："不能禁用自己的账号"
- ✅ 用户状态未改变

---

### 11. 分页功能测试

**操作**：
1. 如果用户总数超过10个，查看分页器
2. 点击"下一页"
3. 点击"上一页"
4. 修改每页显示数量（10/20/50/100）
5. 跳转到指定页码

**预期结果**：
- ✅ 分页器正常显示
- ✅ 翻页功能正常
- ✅ 每页数量切换正常
- ✅ 显示"共 X 个用户"

---

### 12. 组合筛选测试

**操作**：
1. 同时使用搜索 + 角色筛选
2. 同时使用角色筛选 + 状态筛选
3. 同时使用搜索 + 角色筛选 + 状态筛选

**预期结果**：
- ✅ 多个筛选条件同时生效
- ✅ 结果正确
- ✅ 分页正常工作

---

### 13. 数据关联测试

**操作**：
1. 在"用户管理"页面找到一个商务人员
2. 记录该商务的姓名
3. 点击"详情"查看其添加的达人数量
4. 切换到"工厂管理"页面
5. 找到该商务所属的工厂
6. 点击"查看详情" → "商务团队"
7. 找到该商务，对比数据

**预期结果**：
- ✅ 两处显示的数据一致
- ✅ 达人数量相同
- ✅ 合作数量相同
- ✅ 数据关联正确

---

## 🐛 常见问题排查

### 问题1：用户列表为空
**排查**：
- 检查数据库是否有用户数据
- 检查后端API是否正常返回
- 查看浏览器控制台是否有错误

### 问题2：禁用/启用按钮无反应
**排查**：
- 检查后端API `/api/platform/users/:userId/toggle-status` 是否正常
- 查看浏览器控制台网络请求
- 确认用户权限（必须是平台管理员）

### 问题3：工作数据显示为0
**排查**：
- 确认该商务是否真的添加过达人
- 检查数据库中的 `createdBy` 字段
- 查看后端统计逻辑是否正确

### 问题4：达人列表/合作列表为空
**排查**：
- 确认该商务是否有相关数据
- 检查后端API返回
- 查看分页参数是否正确

---

## 📊 测试结果记录

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 1. 菜单导航 | ⬜ 待测试 | |
| 2. 用户列表查看 | ⬜ 待测试 | |
| 3. 搜索功能 | ⬜ 待测试 | |
| 4. 角色筛选 | ⬜ 待测试 | |
| 5. 状态筛选 | ⬜ 待测试 | |
| 6. 工厂老板详情 | ⬜ 待测试 | |
| 7. 商务人员详情 | ⬜ 待测试 | |
| 8. 禁用用户 | ⬜ 待测试 | |
| 9. 启用用户 | ⬜ 待测试 | |
| 10. 安全保护 | ⬜ 待测试 | |
| 11. 分页功能 | ⬜ 待测试 | |
| 12. 组合筛选 | ⬜ 待测试 | |
| 13. 数据关联 | ⬜ 待测试 | |

---

## 🎯 测试完成标准

- ✅ 所有测试项通过
- ✅ 无明显UI问题
- ✅ 无功能性bug
- ✅ 数据准确性验证通过
- ✅ 安全保护机制正常工作

---

**测试人员**: ___________  
**测试日期**: ___________  
**测试结果**: ⬜ 通过 / ⬜ 不通过  
**问题记录**: ___________

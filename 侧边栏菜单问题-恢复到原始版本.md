# 侧边栏菜单问题 - 恢复到原始版本

## 问题分析

通过检查 git 历史，发现：

1. **最新提交 `7f047c5`**：修复菜单路由路径，添加 /app 前缀
2. **当前代码状态**：
   - 菜单路径已经正确使用 `/app` 前缀
   - 路由配置也使用 `/app` 前缀
   - 但是有调试代码（console.log）

## 已执行的操作

### 1. 移除调试代码

从 `MainLayout.tsx` 中移除了以下调试代码：

```typescript
// 调试信息
console.log('MainLayout render:', {
  user,
  role: user?.role,
  pathname: location.pathname,
  menuItems: getMenuItems(user?.role || '')
});
```

### 2. 当前菜单配置

**商务人员 (BUSINESS_STAFF) 应该看到的菜单**：
- ✅ 工作台 (`/app/dashboard`)
- ✅ 达人管理 (`/app/influencers`)
- ✅ 合作管道 (`/app/pipeline`)
- ✅ 合作结果 (`/app/results`)

**工厂老板 (FACTORY_OWNER) 应该看到的菜单**：
- ✅ 工作台 (`/app/dashboard`)
- ✅ 达人管理 (`/app/influencers`)
- ✅ 合作管道 (`/app/pipeline`)
- ✅ 合作结果 (`/app/results`)
- ✅ 样品管理 (`/app/samples`)
- ✅ 数据报表 (`/app/reports`)
- ✅ 团队管理 (`/app/team`)

## 下一步测试

请执行以下操作：

### 1. 清除浏览器缓存和 localStorage

在浏览器控制台执行：
```javascript
localStorage.clear();
location.reload();
```

### 2. 重新登录商务人员账号

- 邮箱：`staff@demo.com`
- 密码：`staff123`

### 3. 检查菜单显示

登录后应该看到 4 个菜单项：
1. 工作台
2. 达人管理
3. 合作管道
4. 合作结果

### 4. 如果仍然有问题

请提供以下信息：
1. 浏览器控制台的截图（按 F12 打开）
2. 菜单显示的截图
3. 在控制台执行以下命令并提供结果：
   ```javascript
   console.log(JSON.parse(localStorage.getItem('auth-storage')))
   ```

## 可能的原因

如果清除缓存后仍然有问题，可能是：

1. **Zustand persist hydration 时序问题**：
   - localStorage 中有数据
   - 但 MainLayout 渲染时，zustand 还没有完成 hydration
   - 导致 `user?.role` 是 `undefined`

2. **React 渲染时序问题**：
   - MainLayout 在 user 数据完全加载前就渲染了

如果是这种情况，我们需要添加 hydration 检查（之前尝试过但没有完全实施）。

---

**当前状态**：已移除调试代码，等待用户测试反馈。

# ä¾§è¾¹æ èœå•é—®é¢˜ - æœ€ç»ˆä¿®å¤

## é—®é¢˜æ ¹æº

å•†åŠ¡äººå‘˜ç™»å½•åï¼Œå·¦ä¾§èœå•åªæ˜¾ç¤º"å·¥ä½œå°"ä¸€ä¸ªèœå•é¡¹ã€‚ç»è¿‡å¤šæ¬¡è°ƒè¯•å‘ç°ï¼š

**é—®é¢˜ä¸æ˜¯æ•°æ®å±‚é¢çš„é—®é¢˜ï¼Œè€Œæ˜¯è¿‡åº¦ä¿®æ”¹å¯¼è‡´çš„å¤æ‚æ€§é—®é¢˜ã€‚**

ä¹‹å‰æ·»åŠ çš„å„ç§"ä¿®å¤"åè€Œç ´åäº†åŸæœ¬ç®€å•å·¥ä½œçš„ä»£ç ï¼š
- âŒ æ·»åŠ äº† `_hasHydrated` æ£€æŸ¥å’Œ Spin åŠ è½½çŠ¶æ€
- âŒ æ·»åŠ äº†å¤æ‚çš„ glass effect UI æ ·å¼
- âŒ æ·»åŠ äº†å·¥å‚çŠ¶æ€ä¿¡æ¯æ˜¾ç¤º
- âŒ æ·»åŠ äº†å„ç§è°ƒè¯•ä»£ç 

## è§£å†³æ–¹æ¡ˆ

**æ¢å¤åˆ°ä¹‹å‰ç®€å•å·¥ä½œçš„ç‰ˆæœ¬**ï¼Œåªä¿ç•™å¿…è¦çš„ `/app` è·¯å¾„å‰ç¼€ä¿®å¤ã€‚

## ä¿®æ”¹å†…å®¹

### 1. `packages/frontend/src/layouts/MainLayout.tsx`

æ¢å¤åˆ°ç®€å•ç‰ˆæœ¬ï¼š
- âœ… ç§»é™¤äº† `_hasHydrated` æ£€æŸ¥å’Œ Spin åŠ è½½çŠ¶æ€
- âœ… ç§»é™¤äº† `theme.useToken()` å’Œå¤æ‚çš„ UI æ ·å¼
- âœ… ç§»é™¤äº† `Button` ç»„ä»¶åŒ…è£¹
- âœ… ç§»é™¤äº†å·¥å‚çŠ¶æ€ä¿¡æ¯æ˜¾ç¤º
- âœ… ç§»é™¤äº† `Layers` icon å’Œ glass effect
- âœ… æ¢å¤åˆ°ç®€å•çš„ light theme Sider
- âœ… ä¿ç•™äº† `/app` è·¯å¾„å‰ç¼€ï¼ˆè¿™æ˜¯æ­£ç¡®çš„ä¿®å¤ï¼‰

### 2. `packages/frontend/src/stores/authStore.ts`

æ¢å¤åˆ°ç®€å•ç‰ˆæœ¬ï¼š
- âœ… ç§»é™¤äº† `_hasHydrated` å­—æ®µ
- âœ… ç§»é™¤äº† `onRehydrateStorage` å›è°ƒ
- âœ… æ¢å¤åˆ°å¹²å‡€çš„ persist é…ç½®

## å…³é”®æ•™è®­

1. **ç®€å•å°±æ˜¯ç¾**ï¼šä¸è¦è¿‡åº¦è®¾è®¡ï¼Œç®€å•çš„ä»£ç å¾€å¾€æ›´å¯é 
2. **ä¸è¦è¿‡åº¦è°ƒè¯•**ï¼šæ·»åŠ å¤ªå¤šè°ƒè¯•ä»£ç åè€Œä¼šç ´ååŸæœ¬å·¥ä½œçš„é€»è¾‘
3. **ç›¸ä¿¡åŸå§‹ä»£ç **ï¼šå¦‚æœä»£ç ä¹‹å‰å·¥ä½œæ­£å¸¸ï¼Œé—®é¢˜å¯èƒ½ä¸åœ¨æ ¸å¿ƒé€»è¾‘
4. **åŠæ—¶å›é€€**ï¼šå½“ä¿®æ”¹è¶Šæ¥è¶Šå¤æ‚æ—¶ï¼Œå›åˆ°å·¥ä½œç‰ˆæœ¬æ˜¯æœ€å¿«çš„è§£å†³æ–¹æ¡ˆ

## æµ‹è¯•æ­¥éª¤

1. **æ¸…é™¤æµè§ˆå™¨ç¼“å­˜**ï¼ˆé‡è¦ï¼ï¼‰ï¼š
   ```javascript
   localStorage.clear();
   sessionStorage.clear();
   location.reload();
   ```

2. **é‡æ–°ç™»å½•**ï¼š
   - å•†åŠ¡äººå‘˜ï¼šstaff@demo.com / staff123
   - å·¥å‚è€æ¿ï¼šowner@demo.com / owner123
   - å¹³å°ç®¡ç†å‘˜ï¼šadmin@demo.com / admin123

3. **æŸ¥çœ‹å·¦ä¾§èœå•**ï¼Œåº”è¯¥æ˜¾ç¤ºæ­£ç¡®çš„èœå•é¡¹ï¼š
   - **å•†åŠ¡äººå‘˜**ï¼ˆ4ä¸ªèœå•é¡¹ï¼‰ï¼š
     - âœ… å·¥ä½œå°
     - âœ… è¾¾äººç®¡ç†
     - âœ… åˆä½œç®¡é“
     - âœ… åˆä½œç»“æœ
   - **å·¥å‚è€æ¿**ï¼ˆ6ä¸ªèœå•é¡¹ï¼‰ï¼š
     - âœ… å·¥ä½œå°
     - âœ… è¾¾äººç®¡ç†
     - âœ… åˆä½œç®¡é“
     - âœ… åˆä½œç»“æœ
     - âœ… æ ·å“ç®¡ç†
     - âœ… æ•°æ®æŠ¥è¡¨
   - **å¹³å°ç®¡ç†å‘˜**ï¼ˆ2ä¸ªèœå•é¡¹ï¼‰ï¼š
     - âœ… å·¥ä½œå°
     - âœ… å¹³å°ç®¡ç†

## ä»£ç å¯¹æ¯”

### ä¹‹å‰ï¼ˆå¤æ‚ç‰ˆæœ¬ï¼‰
```typescript
const MainLayout = () => {
  const { user, logout, _hasHydrated } = useAuthStore();
  const { token } = theme.useToken();

  // ç­‰å¾… hydration å®Œæˆ
  if (!_hasHydrated) {
    return <Spin size="large" tip="åŠ è½½ä¸­..." />;
  }
  
  // å¤æ‚çš„ glass effect UI
  // å·¥å‚çŠ¶æ€ä¿¡æ¯æ˜¾ç¤º
  // ...
}
```

### ç°åœ¨ï¼ˆç®€å•ç‰ˆæœ¬ï¼‰
```typescript
const MainLayout = () => {
  const { user, logout } = useAuthStore();
  
  // ç›´æ¥æ¸²æŸ“ï¼Œç®€å•å¯é 
  return (
    <Layout style={{ minHeight: '100vh' }}>
      <Sider trigger={null} collapsible collapsed={collapsed} theme="light">
        {/* ç®€å•çš„èœå• */}
      </Sider>
      {/* ... */}
    </Layout>
  );
}
```

---

**è¯·æ¸…é™¤ç¼“å­˜å¹¶é‡æ–°ç™»å½•æµ‹è¯•ï¼** ğŸ¯

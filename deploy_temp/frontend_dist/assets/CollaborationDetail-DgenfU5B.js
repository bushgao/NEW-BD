import{e as w,ad as L,u as R,r as l,j as e,S as z}from"./index-CT9F3akh.js";import{d as B,c as A}from"./influencer-portal.service-6g17WHCp.js";import{C as m,a as g}from"./Card-D9YXdlEe.js";import{s as o}from"./index-DBkC0DaV.js";import{E as p}from"./index-DfnzXlZl.js";import{S as y}from"./index-B4IHrhqI.js";import{B as f}from"./button-BCSOJgfZ.js";import{R as H}from"./ArrowLeftOutlined-CvYhJAPh.js";import{T as P}from"./index-WSGRBNKI.js";import{D as a}from"./index-BIA-WqSn.js";import{T as i}from"./index-DnlS8_jt.js";import{B as D}from"./index-6l5o2ZFH.js";import{F as O}from"./Table-pvERNZVb.js";import{T as U}from"./Timeline-B9Bz9J_T.js";import{R as $}from"./GiftOutlined-B6rzlFEA.js";import{R as M}from"./TextArea-Dl3y1VrD.js";import"./UnstableContext-DKFbPjPy.js";import"./Overflow-Gz7ZFAqv.js";import"./PurePanel-DcW2x34y.js";import"./SearchOutlined-CyHaylvE.js";import"./index-Do9OUhYv.js";import"./useBreakpoint--6XYT0_e.js";import"./extendsObject-78o_rR5W.js";import"./index-Dd1FzYQF.js";import"./Input-UrGHJeeK.js";import"./index-BndKrrhJ.js";import"./LeftOutlined-DGEyRIvL.js";import"./EllipsisOutlined-Bv641ndy.js";import"./Pagination-6AhiOKxV.js";const{Title:V,Text:n}=P,E={LEAD:"线索达人",CONTACTED:"已联系",QUOTED:"已报价",SAMPLED:"已寄样",SCHEDULED:"已排期",PUBLISHED:"已发布",REVIEWED:"已复盘"},b={LEAD:"default",CONTACTED:"blue",QUOTED:"cyan",SAMPLED:"purple",SCHEDULED:"orange",PUBLISHED:"green",REVIEWED:"gold"},ye=()=>{const{theme:x}=w(),{id:d}=L(),v=R(),[S,h]=l.useState(!0),[s,I]=l.useState(null),[C,u]=l.useState(null);l.useEffect(()=>{d&&j()},[d]);const j=async()=>{var t;h(!0);try{const r=await B(d);r.success&&r.data?I(r.data):o.error(((t=r.error)==null?void 0:t.message)||"加载失败")}catch{o.error("加载失败，请稍后重试")}finally{h(!1)}},T=async t=>{var r;u(t);try{const c=await A(t);c.success?(o.success("签收成功"),j()):o.error(((r=c.error)==null?void 0:r.message)||"签收失败")}catch{o.error("签收失败，请稍后重试")}finally{u(null)}},k=t=>{switch(t){case"PENDING":return e.jsx(i,{color:"orange",children:"待签收"});case"RECEIVED":return e.jsx(i,{color:"green",children:"已签收"});case"LOST":return e.jsx(i,{color:"red",children:"已丢失"});default:return e.jsx(i,{children:t})}},N=[{title:"样品名称",dataIndex:"sampleName",key:"sampleName",render:(t,r)=>e.jsxs(y,{children:[e.jsx($,{style:{color:"#722ed1"}}),e.jsx("span",{children:t}),e.jsxs(n,{type:"secondary",children:["(",r.sampleSku,")"]})]})},{title:"数量",dataIndex:"quantity",key:"quantity",width:80},{title:"寄出时间",dataIndex:"dispatchedAt",key:"dispatchedAt",width:120,render:t=>new Date(t).toLocaleDateString("zh-CN")},{title:"快递单号",dataIndex:"trackingNumber",key:"trackingNumber",width:150,render:t=>t||e.jsx(n,{type:"secondary",children:"暂无"})},{title:"状态",dataIndex:"receivedStatus",key:"receivedStatus",width:100,render:t=>k(t)},{title:"操作",key:"action",width:120,render:(t,r)=>r.receivedStatus==="PENDING"?e.jsx(f,{type:"primary",size:"small",icon:e.jsx(M,{}),loading:C===r.id,onClick:()=>T(r.id),style:{background:"#722ed1",borderColor:"#722ed1"},children:"确认签收"}):null}];return S?e.jsx("div",{style:{textAlign:"center",padding:100},children:e.jsx(z,{size:"large"})}):s?e.jsxs("div",{style:{minHeight:"100vh",background:`linear-gradient(135deg, ${x.colors.background.secondary} 0%, ${x.colors.background.tertiary} 100%)`,position:"relative",padding:"24px",margin:"-24px"},children:[e.jsx("div",{style:{position:"absolute",top:"10%",left:"5%",width:"400px",height:"400px",background:"linear-gradient(135deg, rgba(90, 200, 250, 0.08), rgba(191, 90, 242, 0.08))",borderRadius:"50%",filter:"blur(80px)",pointerEvents:"none",zIndex:0}}),e.jsx("div",{style:{position:"absolute",top:"40%",right:"10%",width:"500px",height:"500px",background:"linear-gradient(135deg, rgba(255, 107, 107, 0.08), rgba(255, 217, 61, 0.08))",borderRadius:"50%",filter:"blur(100px)",pointerEvents:"none",zIndex:0}}),e.jsxs("div",{style:{position:"relative",zIndex:1},children:[e.jsxs(y,{style:{marginBottom:24},children:[e.jsx(f,{icon:e.jsx(H,{}),onClick:()=>v(-1),children:"返回"}),e.jsx(V,{level:4,style:{margin:0},children:"合作详情"})]}),e.jsx(m,{variant:"elevated",style:{marginBottom:16},children:e.jsxs(g,{children:[e.jsx("div",{style:{marginBottom:16},children:e.jsx(n,{strong:!0,style:{fontSize:16},children:"基本信息"})}),e.jsxs(a,{column:{xs:1,sm:2,md:3},children:[e.jsx(a.Item,{label:"工厂",children:s.factoryName}),e.jsx(a.Item,{label:"当前阶段",children:e.jsx(i,{color:b[s.stage]||"default",children:E[s.stage]||s.stage})}),e.jsx(a.Item,{label:"状态",children:s.isOverdue?e.jsx(D,{status:"error",text:"已超期"}):e.jsx(D,{status:"success",text:"正常"})}),e.jsx(a.Item,{label:"截止时间",children:s.deadline?new Date(s.deadline).toLocaleDateString("zh-CN"):"未设置"}),e.jsx(a.Item,{label:"创建时间",children:new Date(s.createdAt).toLocaleDateString("zh-CN")}),e.jsxs(a.Item,{label:"样品数量",children:[s.samples.length," 件"]})]})]})}),e.jsx(m,{variant:"elevated",style:{marginBottom:16},children:e.jsxs(g,{children:[e.jsx("div",{style:{marginBottom:16},children:e.jsx(n,{strong:!0,style:{fontSize:16},children:"关联样品"})}),s.samples.length>0?e.jsx(O,{dataSource:s.samples,columns:N,rowKey:"id",pagination:!1,size:"small"}):e.jsx(p,{description:"暂无关联样品"})]})}),e.jsx(m,{variant:"elevated",children:e.jsxs(g,{children:[e.jsx("div",{style:{marginBottom:16},children:e.jsx(n,{strong:!0,style:{fontSize:16},children:"阶段变更历史"})}),s.stageHistory.length>0?e.jsx(U,{mode:"left",items:s.stageHistory.map((t,r)=>({color:r===s.stageHistory.length-1?"#722ed1":"gray",children:e.jsxs("div",{children:[e.jsx(i,{color:b[t.stage]||"default",children:E[t.stage]||t.stage}),e.jsx(n,{type:"secondary",style:{marginLeft:8},children:new Date(t.changedAt).toLocaleString("zh-CN")})]})}))}):e.jsx(p,{description:"暂无阶段变更记录"})]})})]})]}):e.jsx(p,{description:"合作记录不存在"})};export{ye as default};

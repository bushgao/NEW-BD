import{e as F,r as i,j as t,S as z}from"./index-CT9F3akh.js";import{g as B,a as A,c as P}from"./influencer-portal.service-6g17WHCp.js";import{d as j}from"./CalendarOutlined-6RDrkSku.js";import{C as v,a as S}from"./Card-D9YXdlEe.js";import{s as o}from"./index-DBkC0DaV.js";import{T as L}from"./index-WSGRBNKI.js";import{S as c}from"./index-B4IHrhqI.js";import{S as b,E as O}from"./index-DfnzXlZl.js";import{D as G}from"./index-DVFXVRcq.js";import{b as M,B as V}from"./button-BCSOJgfZ.js";import{F as $}from"./Table-pvERNZVb.js";import{T as l}from"./index-DnlS8_jt.js";import{R as q}from"./GiftOutlined-B6rzlFEA.js";import{R as K}from"./TextArea-Dl3y1VrD.js";import{M as H}from"./index-CxrQydPb.js";import"./PurePanel-DcW2x34y.js";import"./Overflow-Gz7ZFAqv.js";import"./UnstableContext-DKFbPjPy.js";import"./SearchOutlined-CyHaylvE.js";import"./ClockCircleOutlined-DAoco557.js";import"./index-Do9OUhYv.js";import"./index-Dd1FzYQF.js";import"./Input-UrGHJeeK.js";import"./index-BndKrrhJ.js";import"./LeftOutlined-DGEyRIvL.js";import"./EllipsisOutlined-Bv641ndy.js";import"./useBreakpoint--6XYT0_e.js";import"./Pagination-6AhiOKxV.js";import"./extendsObject-78o_rR5W.js";import"./ActionButton-DPGDuFxb.js";import"./Skeleton-DdNqplha.js";import"./index-BoArUKpt.js";import"./fade-pCPugiYp.js";const{RangePicker:_}=G,{Title:J,Text:p}=L,De=()=>{const{theme:m}=F(),[u,h]=i.useState(!0),[n,I]=i.useState(null),[w,k]=i.useState([]),[s,g]=i.useState({}),[C,x]=i.useState(null);i.useEffect(()=>{D(),d()},[]);const D=async()=>{try{const e=await B();e.success&&e.data&&k(e.data)}catch(e){console.error("加载工厂列表失败",e)}},d=async e=>{var r;h(!0);try{const a=await A(e||s);a.success&&a.data?I(a.data):o.error(((r=a.error)==null?void 0:r.message)||"加载失败")}catch{o.error("加载失败，请稍后重试")}finally{h(!1)}},y=(e,r)=>{const a={...s,[e]:r};g(a),d(a)},E=e=>{var a,f;const r={...s,startDate:(a=e==null?void 0:e[0])==null?void 0:a.toISOString(),endDate:(f=e==null?void 0:e[1])==null?void 0:f.toISOString()};g(r),d(r)},R=async e=>{H.confirm({title:"确认签收",content:"确认已收到该样品吗？",okText:"确认签收",cancelText:"取消",onOk:async()=>{var r;x(e);try{const a=await P(e);a.success?(o.success("签收成功"),d()):o.error(((r=a.error)==null?void 0:r.message)||"签收失败")}catch{o.error("签收失败，请稍后重试")}finally{x(null)}}})},N=e=>{switch(e){case"PENDING":return t.jsx(l,{color:"orange",children:"待签收"});case"RECEIVED":return t.jsx(l,{color:"green",children:"已签收"});case"LOST":return t.jsx(l,{color:"red",children:"已丢失"});default:return t.jsx(l,{children:e})}},T=[{title:"样品名称",dataIndex:"sampleName",key:"sampleName",render:(e,r)=>t.jsxs(c,{children:[t.jsx(q,{style:{color:"#722ed1"}}),t.jsx("span",{children:e}),t.jsxs(p,{type:"secondary",children:["(",r.sampleSku,")"]})]})},{title:"数量",dataIndex:"quantity",key:"quantity",width:80},{title:"寄出时间",dataIndex:"dispatchedAt",key:"dispatchedAt",width:120,render:e=>new Date(e).toLocaleDateString("zh-CN")},{title:"快递单号",dataIndex:"trackingNumber",key:"trackingNumber",width:150,render:e=>e||t.jsx(p,{type:"secondary",children:"暂无"})},{title:"状态",dataIndex:"receivedStatus",key:"receivedStatus",width:100,render:e=>N(e)},{title:"操作",key:"action",width:120,render:(e,r)=>r.receivedStatus==="PENDING"?t.jsx(V,{type:"primary",size:"small",icon:t.jsx(K,{}),loading:C===r.id,onClick:()=>R(r.id),style:{background:"#722ed1",borderColor:"#722ed1"},children:"确认签收"}):r.receivedStatus==="RECEIVED"&&r.receivedAt?t.jsxs(p,{type:"secondary",style:{fontSize:12},children:[new Date(r.receivedAt).toLocaleDateString("zh-CN")," 签收"]}):null}];return u&&!n?t.jsx("div",{style:{textAlign:"center",padding:100},children:t.jsx(z,{size:"large"})}):t.jsxs("div",{style:{minHeight:"100vh",background:`linear-gradient(135deg, ${m.colors.background.secondary} 0%, ${m.colors.background.tertiary} 100%)`,position:"relative",padding:"24px",margin:"-24px"},children:[t.jsx("div",{style:{position:"absolute",top:"10%",left:"5%",width:"400px",height:"400px",background:"linear-gradient(135deg, rgba(90, 200, 250, 0.08), rgba(191, 90, 242, 0.08))",borderRadius:"50%",filter:"blur(80px)",pointerEvents:"none",zIndex:0}}),t.jsx("div",{style:{position:"absolute",top:"40%",right:"10%",width:"500px",height:"500px",background:"linear-gradient(135deg, rgba(255, 107, 107, 0.08), rgba(255, 217, 61, 0.08))",borderRadius:"50%",filter:"blur(100px)",pointerEvents:"none",zIndex:0}}),t.jsxs("div",{style:{position:"relative",zIndex:1},children:[t.jsx(J,{level:4,style:{marginBottom:24},children:"我的样品"}),t.jsx(v,{variant:"elevated",style:{marginBottom:16},children:t.jsx(S,{children:t.jsxs(c,{wrap:!0,children:[t.jsx(b,{placeholder:"选择工厂",allowClear:!0,style:{width:200},value:s.brandId,onChange:e=>y("brandId",e),options:w.map(e=>({label:e.name,value:e.id}))}),t.jsx(b,{placeholder:"签收状态",allowClear:!0,style:{width:120},value:s.receivedStatus,onChange:e=>y("receivedStatus",e),options:[{label:"待签收",value:"PENDING"},{label:"已签收",value:"RECEIVED"},{label:"已丢失",value:"LOST"}]}),t.jsx(_,{placeholder:["开始日期","结束日期"],onChange:E,value:s.startDate&&s.endDate?[j(s.startDate),j(s.endDate)]:void 0})]})})}),n&&n.groupedByFactory.length>0?t.jsx(M,{defaultActiveKey:n.groupedByFactory.map(e=>e.brandId),items:n.groupedByFactory.map(e=>({key:e.brandId,label:t.jsxs(c,{children:[t.jsx("span",{children:e.factoryName}),t.jsxs(l,{children:[e.samples.length," 件样品"]})]}),children:t.jsx($,{dataSource:e.samples,columns:T,rowKey:"id",pagination:!1,size:"small",loading:u})}))}):t.jsx(v,{variant:"elevated",children:t.jsx(S,{children:t.jsx(O,{description:"暂无样品记录"})})})]})]})};export{De as default};

import{r,j as t}from"./index-CT9F3akh.js";import{s as N,v as $}from"./global-influencer.service-DgptB4Yw.js";import{s as c}from"./index-DBkC0DaV.js";import{S as m}from"./index-B4IHrhqI.js";import{I as w,R as z}from"./index-htVVH06X.js";import{S as l}from"./index-DfnzXlZl.js";import{B as s}from"./button-BCSOJgfZ.js";import{F as J}from"./Table-pvERNZVb.js";import{M as P}from"./index-CxrQydPb.js";import{R as U}from"./CloseCircleOutlined-D2hdQaev.js";import{R as g}from"./SafetyCertificateOutlined-DItUwWUC.js";import{R as B}from"./TeamOutlined-Bai9oLhN.js";import{T as k}from"./index-DnlS8_jt.js";const G={PLATFORM:"平台添加",FACTORY:"品牌添加",STAFF:"商务添加",SELF_REGISTER:"达人自注册"},_={UNVERIFIED:"未认证",VERIFIED:"已认证",REJECTED:"认证失败"},K={PLATFORM:"blue",FACTORY:"green",STAFF:"default",SELF_REGISTER:"purple"},Y={UNVERIFIED:"warning",VERIFIED:"success",REJECTED:"error"};function ie(){const[C,T]=r.useState([]),[v,x]=r.useState(!1),[d,h]=r.useState(1),[u,F]=r.useState(20),[D,V]=r.useState(0),[p,E]=r.useState(""),[f,y]=r.useState(""),[A,o]=r.useState(!1),[a,O]=r.useState(null),[S,I]=r.useState("");r.useEffect(()=>{i()},[d,u]);const i=async()=>{x(!0);try{const e={page:d,pageSize:u};p&&(e.keyword=p),f&&(e.verificationStatus=f);const n=await N(e);T(n.data),V(n.total)}catch(e){c.error(e.message||"加载达人列表失败")}finally{x(!1)}},j=()=>{h(1),i()},b=()=>{E(""),y(""),h(1),setTimeout(i,0)},L=e=>{O(e),I(""),o(!0)},R=async e=>{if(a)try{await $(a.id,e,S),c.success(e==="VERIFIED"?"认证成功":"已拒绝认证"),o(!1),i()}catch(n){c.error(n.message||"操作失败")}},M=[{title:"昵称",dataIndex:"nickname",key:"nickname",width:150},{title:"手机号",dataIndex:"phone",key:"phone",width:130,render:e=>e||"-"},{title:"微信号",dataIndex:"wechat",key:"wechat",width:130,render:e=>e||"-"},{title:"合作品牌数",dataIndex:"brandCount",key:"brandCount",width:100,render:e=>t.jsxs(m,{children:[t.jsx(B,{}),t.jsx("span",{children:e||0})]})},{title:"来源",dataIndex:"sourceType",key:"sourceType",width:100,render:e=>t.jsx(k,{color:K[e],children:G[e]})},{title:"认证状态",dataIndex:"verificationStatus",key:"verificationStatus",width:100,render:e=>t.jsx(k,{color:Y[e],children:_[e]})},{title:"入库时间",dataIndex:"createdAt",key:"createdAt",width:120,render:e=>new Date(e).toLocaleDateString()},{title:"操作",key:"actions",width:150,fixed:"right",render:(e,n)=>t.jsxs(m,{children:[t.jsx(s,{type:"link",size:"small",icon:t.jsx(z,{}),onClick:()=>c.info(`查看达人详情：${n.nickname}`),children:"查看"}),n.verificationStatus==="UNVERIFIED"&&t.jsx(s,{type:"link",size:"small",icon:t.jsx(g,{}),onClick:()=>L(n),children:"认证"})]})}];return t.jsxs("div",{children:[t.jsx("div",{style:{marginBottom:16},children:t.jsxs(m,{wrap:!0,children:[t.jsx(w,{placeholder:"搜索昵称/手机号/微信号",value:p,onChange:e=>E(e.target.value),onPressEnter:j,style:{width:200}}),t.jsxs(l,{placeholder:"认证状态",value:f,onChange:y,style:{width:120},allowClear:!0,children:[t.jsx(l.Option,{value:"UNVERIFIED",children:"未认证"}),t.jsx(l.Option,{value:"VERIFIED",children:"已认证"}),t.jsx(l.Option,{value:"REJECTED",children:"认证失败"})]}),t.jsx(s,{type:"primary",onClick:j,children:"搜索"}),t.jsx(s,{onClick:b,children:"重置"})]})}),t.jsx(J,{columns:M,dataSource:C,loading:v,rowKey:"id",scroll:{x:1e3},pagination:{current:d,pageSize:u,total:D,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 位达人`,onChange:(e,n)=>{h(e),F(n)}}}),t.jsxs(P,{title:`认证达人：${a==null?void 0:a.nickname}`,open:A,onCancel:()=>o(!1),footer:[t.jsx(s,{onClick:()=>o(!1),children:"取消"},"cancel"),t.jsx(s,{danger:!0,icon:t.jsx(U,{}),onClick:()=>R("REJECTED"),children:"拒绝"},"reject"),t.jsx(s,{type:"primary",icon:t.jsx(g,{}),onClick:()=>R("VERIFIED"),children:"通过认证"},"approve")],children:[t.jsxs("p",{children:["手机号：",(a==null?void 0:a.phone)||"-"]}),t.jsxs("p",{children:["微信号：",(a==null?void 0:a.wechat)||"-"]}),t.jsx(w.TextArea,{placeholder:"备注（拒绝时请填写原因）",value:S,onChange:e=>I(e.target.value),rows:3})]})]})}export{ie as I};

import{e as W,r as o,j as e}from"./index-CT9F3akh.js";import{P as U,g as J,c as T}from"./global-influencer.service-DgptB4Yw.js";import{F as n}from"./index-gbW5J2sR.js";import{R as y,C as m}from"./row-DVjUYxl3.js";import{T as Q}from"./index-WSGRBNKI.js";import{C}from"./index-DSHlf2Aa.js";import{T as X}from"./index-DiUoGV2L.js";import{I as p}from"./index-htVVH06X.js";import{S as Z}from"./index-DfnzXlZl.js";import{B as i}from"./button-BCSOJgfZ.js";import{R as ee}from"./PlusOutlined-oMbGAVrA.js";import{S as R}from"./index-B4IHrhqI.js";import{U as te}from"./index-BFjyBC68.js";import{R as re}from"./UploadOutlined-mPGRaQgN.js";import{R as se}from"./DownloadOutlined-uTWihTI_.js";import{R as ae}from"./CheckCircleOutlined-eJc7nheY.js";import{F as D}from"./Table-pvERNZVb.js";import{s as f}from"./index-DBkC0DaV.js";import{T as k}from"./index-DnlS8_jt.js";import"./api-W_2ufh2E.js";import"./TextArea-Dl3y1VrD.js";import"./Input-UrGHJeeK.js";import"./QuestionCircleOutlined-CZssou_a.js";import"./index-BoArUKpt.js";import"./useBreakpoint--6XYT0_e.js";import"./Skeleton-DdNqplha.js";import"./EllipsisOutlined-Bv641ndy.js";import"./Overflow-Gz7ZFAqv.js";import"./UnstableContext-DKFbPjPy.js";import"./SearchOutlined-CyHaylvE.js";import"./PurePanel-DcW2x34y.js";import"./index-Do9OUhYv.js";import"./fade-pCPugiYp.js";import"./DeleteOutlined-TK3JP8uX.js";import"./progress-CYBat26e.js";import"./index-Dd1FzYQF.js";import"./index-BndKrrhJ.js";import"./LeftOutlined-DGEyRIvL.js";import"./Pagination-6AhiOKxV.js";import"./extendsObject-78o_rR5W.js";const{Title:L,Text:oe,Paragraph:ne}=Q,{TextArea:le}=p,ie=Object.entries(U).map(([u,g])=>({label:g,value:u})),We=()=>{const{theme:u}=W(),[g]=n.useForm(),[F,v]=o.useState("single"),[A,b]=o.useState(!1),[c,I]=o.useState([]),[z,w]=o.useState(!1),[O,B]=o.useState([]),[E,S]=o.useState(!1),[$,P]=o.useState(0),[M,q]=o.useState(1),[h,j]=o.useState("session"),[_]=o.useState(new Date),d=async(t=1,r=h)=>{S(!0);try{let s;const l=new Date;r==="session"?s=_.toISOString():r==="1h"?s=new Date(l.getTime()-60*60*1e3).toISOString():r==="24h"&&(s=new Date(l.getTime()-24*60*60*1e3).toISOString());const a=await J({page:t,pageSize:10,createdAfter:s});B(a.data),P(a.total),q(t)}catch{f.error("åŠ è½½è¾¾äººåˆ—è¡¨å¤±è´¥")}finally{S(!1)}};o.useEffect(()=>{d()},[]);const G=async t=>{var r,s;b(!0);try{await T({nickname:t.nickname,phone:t.phone,wechat:t.wechat,platformAccounts:[{platform:t.platform,platformId:t.platformId,followers:t.followers,profileUrl:t.homeUrl}]}),f.success("è¾¾äººå·²æ·»åŠ åˆ°å…¨å±€è¾¾äººæ± "),g.resetFields(),d()}catch(l){f.error(((s=(r=l.response)==null?void 0:r.data)==null?void 0:s.message)||"æ·»åŠ å¤±è´¥")}finally{b(!1)}},K=t=>(f.info("Excel è§£æžåŠŸèƒ½å¾…å®žçŽ°ï¼Œè¯·ä½¿ç”¨æ¨¡æ¿æ ¼å¼"),I([{key:"1",nickname:"ç¤ºä¾‹è¾¾äºº1",platform:"DOUYIN",platformId:"example1",uid:"uid001",followers:"100000",status:"pending"}]),!1),N=()=>{const t=["æ˜µç§°","å¹³å°","è´¦å·ID","UID","ç²‰ä¸æ•°","æ‰‹æœºå·","å¾®ä¿¡å·","ä¸»é¡µ","å¤‡æ³¨"],r=["ç¤ºä¾‹è¾¾äºº","DOUYIN","example123","uid001","10000","13800138000","wx123","https://...","å¤‡æ³¨å†…å®¹"],s=[t.join(","),r.join(",")].join(`
`),l=new Blob(["\uFEFF"+s],{type:"text/csv;charset=utf-8"}),a=URL.createObjectURL(l),x=document.createElement("a");x.href=a,x.download="è¾¾äººå¯¼å…¥æ¨¡æ¿.csv",x.click(),URL.revokeObjectURL(a)},Y=async()=>{var s,l;if(c.length===0){f.warning("æ²¡æœ‰å¾…å¯¼å…¥çš„æ•°æ®");return}w(!0);let t=0,r=0;for(const a of c){try{await T({nickname:a.nickname,platformAccounts:[{platform:a.platform,platformId:a.platformId,followers:a.followers}]}),a.status="success",t++}catch(x){a.status="error",a.errorMsg=((l=(s=x.response)==null?void 0:s.data)==null?void 0:l.message)||"å¯¼å…¥å¤±è´¥",r++}I([...c])}w(!1),f.info(`å¯¼å…¥å®Œæˆï¼šæˆåŠŸ ${t} æ¡ï¼Œå¤±è´¥ ${r} æ¡`)},H=t=>{I(c.filter(r=>r.key!==t))},V=[{title:"æ˜µç§°",dataIndex:"nickname",key:"nickname"},{title:"å¹³å°",dataIndex:"platform",key:"platform",render:t=>U[t]||t},{title:"è´¦å·ID",dataIndex:"platformId",key:"platformId"},{title:"UID",dataIndex:"uid",key:"uid"},{title:"ç²‰ä¸æ•°",dataIndex:"followers",key:"followers"},{title:"çŠ¶æ€",dataIndex:"status",key:"status",render:(t,r)=>t==="success"?e.jsx(k,{color:"success",children:"æˆåŠŸ"}):t==="error"?e.jsx(k,{color:"error",title:r.errorMsg,children:"å¤±è´¥"}):e.jsx(k,{children:"å¾…å¯¼å…¥"})},{title:"æ“ä½œ",key:"action",render:(t,r)=>e.jsx(i,{type:"link",danger:!0,size:"small",onClick:()=>H(r.key),children:"åˆ é™¤"})}];return e.jsx("div",{style:{padding:"24px",margin:"-24px",background:`linear-gradient(135deg, ${u.colors.background.secondary} 0%, ${u.colors.background.tertiary} 100%)`,minHeight:"100vh"},children:e.jsxs("div",{style:{position:"relative",zIndex:1},children:[e.jsx(y,{justify:"space-between",align:"middle",style:{marginBottom:24},children:e.jsxs(m,{children:[e.jsx(L,{level:4,style:{margin:0},children:"ðŸŽ¯ è¾¾äººå…¥åº“"}),e.jsx(ne,{type:"secondary",style:{marginTop:8,marginBottom:0},children:"å°†è¾¾äººæ·»åŠ åˆ°å…¨å±€è¾¾äººæ± ï¼Œå“ç‰Œå¯ä»Žè¾¾äººæ± ä¸­é€‰æ‹©è¾¾äººè¿›è¡Œåˆä½œ"})]})}),e.jsx(C,{style:{background:"#fff",border:"1px solid #f0f0f0",borderRadius:6},bodyStyle:{padding:24},children:e.jsx(X,{activeKey:F,onChange:v,items:[{key:"single",label:"âœï¸ å•ç‹¬æ·»åŠ ",children:e.jsxs(n,{form:g,layout:"vertical",onFinish:G,style:{maxWidth:600},children:[e.jsxs(y,{gutter:16,children:[e.jsx(m,{span:12,children:e.jsx(n.Item,{name:"nickname",label:"è¾¾äººæ˜µç§°",rules:[{required:!0,message:"è¯·è¾“å…¥è¾¾äººæ˜µç§°"}],children:e.jsx(p,{placeholder:"è¯·è¾“å…¥è¾¾äººæ˜µç§°"})})}),e.jsx(m,{span:12,children:e.jsx(n.Item,{name:"platform",label:"å¹³å°",rules:[{required:!0,message:"è¯·é€‰æ‹©å¹³å°"}],children:e.jsx(Z,{placeholder:"é€‰æ‹©å¹³å°",options:ie})})})]}),e.jsxs(y,{gutter:16,children:[e.jsx(m,{span:12,children:e.jsx(n.Item,{name:"platformId",label:"å¹³å°è´¦å·ID",rules:[{required:!0,message:"è¯·è¾“å…¥è´¦å·ID"}],children:e.jsx(p,{placeholder:"è¯·è¾“å…¥å¹³å°è´¦å·ID"})})}),e.jsx(m,{span:12,children:e.jsx(n.Item,{name:"followers",label:"ç²‰ä¸æ•°",children:e.jsx(p,{placeholder:"å¦‚ï¼š100000"})})})]}),e.jsxs(y,{gutter:16,children:[e.jsx(m,{span:12,children:e.jsx(n.Item,{name:"phone",label:"æ‰‹æœºå·",children:e.jsx(p,{placeholder:"è¯·è¾“å…¥æ‰‹æœºå·"})})}),e.jsx(m,{span:12,children:e.jsx(n.Item,{name:"wechat",label:"å¾®ä¿¡å·",children:e.jsx(p,{placeholder:"è¯·è¾“å…¥å¾®ä¿¡å·"})})})]}),e.jsx(n.Item,{name:"homeUrl",label:"ä¸»é¡µé“¾æŽ¥",children:e.jsx(p,{placeholder:"è¯·è¾“å…¥ä¸»é¡µé“¾æŽ¥"})}),e.jsx(n.Item,{name:"notes",label:"å¤‡æ³¨",children:e.jsx(le,{rows:3,placeholder:"è¯·è¾“å…¥å¤‡æ³¨"})}),e.jsx(n.Item,{children:e.jsx(i,{type:"primary",htmlType:"submit",loading:A,icon:e.jsx(ee,{}),children:"æ·»åŠ åˆ°è¾¾äººæ± "})})]})},{key:"import",label:"ðŸ“¥ Excelå¯¼å…¥",children:e.jsxs("div",{children:[e.jsxs(R,{style:{marginBottom:16},children:[e.jsx(te,{accept:".xlsx,.xls,.csv",beforeUpload:K,showUploadList:!1,children:e.jsx(i,{icon:e.jsx(re,{}),children:"é€‰æ‹©æ–‡ä»¶"})}),e.jsx(i,{icon:e.jsx(se,{}),onClick:N,children:"ä¸‹è½½æ¨¡æ¿"}),c.length>0&&e.jsxs(i,{type:"primary",icon:e.jsx(ae,{}),onClick:Y,loading:z,children:["ç¡®è®¤å¯¼å…¥ (",c.length," æ¡)"]})]}),c.length>0?e.jsx(D,{columns:V,dataSource:c,size:"small",pagination:!1,scroll:{x:!0}}):e.jsx("div",{style:{textAlign:"center",padding:60,background:"#fafafa",borderRadius:6},children:e.jsx(oe,{type:"secondary",children:"è¯·ä¸Šä¼  Excel æˆ– CSV æ–‡ä»¶ï¼Œæˆ–å…ˆä¸‹è½½æ¨¡æ¿å¡«å†™åŽä¸Šä¼ "})})]})}]})}),e.jsxs(C,{style:{background:"#fff",border:"1px solid #f0f0f0",borderRadius:6,marginTop:24},bodyStyle:{padding:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx(L,{level:5,style:{margin:0},children:"ðŸ“‹ æœ€è¿‘å…¥åº“è®°å½•"}),e.jsxs(R,{children:[e.jsx(i,{type:h==="session"?"primary":"default",size:"small",onClick:()=>{j("session"),d(1,"session")},children:"æœ¬æ¬¡"}),e.jsx(i,{type:h==="1h"?"primary":"default",size:"small",onClick:()=>{j("1h"),d(1,"1h")},children:"1å°æ—¶å†…"}),e.jsx(i,{type:h==="24h"?"primary":"default",size:"small",onClick:()=>{j("24h"),d(1,"24h")},children:"24å°æ—¶å†…"}),e.jsx(i,{type:h==="all"?"primary":"default",size:"small",onClick:()=>{j("all"),d(1,"all")},children:"å…¨éƒ¨"})]})]}),e.jsx(D,{loading:E,dataSource:O,rowKey:"id",size:"small",pagination:{current:M,total:$,pageSize:10,onChange:t=>d(t),showTotal:t=>`å…± ${t} æ¡`},columns:[{title:"æ˜µç§°",dataIndex:"nickname",key:"nickname"},{title:"æ‰‹æœºå·",dataIndex:"phone",key:"phone",render:t=>t||"-"},{title:"å¾®ä¿¡å·",dataIndex:"wechat",key:"wechat",render:t=>t||"-"},{title:"åˆä½œå“ç‰Œæ•°",dataIndex:"brandCount",key:"brandCount",render:t=>t||0},{title:"å…¥åº“æ—¶é—´",dataIndex:"createdAt",key:"createdAt",render:t=>t?new Date(t).toLocaleDateString():"-"}]})]})]})})};export{We as default};

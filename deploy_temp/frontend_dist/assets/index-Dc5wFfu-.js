import{e as b,r as d,j as t,S as w}from"./index-CT9F3akh.js";import{k,l as O}from"./report.service-DH8L8GH2.js";import{C as n,a as l}from"./Card-D9YXdlEe.js";import{T as $}from"./index-WSGRBNKI.js";import{S as D}from"./index-B4IHrhqI.js";import{D as E}from"./index-DVFXVRcq.js";import{B as y}from"./button-BCSOJgfZ.js";import{R as G}from"./ReloadOutlined-C8FTNWWf.js";import{R as P}from"./DownloadOutlined-uTWihTI_.js";import{R as T,C as m}from"./row-DVjUYxl3.js";import{S as c}from"./index-C_yDWHqX.js";import{R as z}from"./TeamOutlined-Bai9oLhN.js";import{R as B}from"./ShoppingOutlined-ozK1Xcir.js";import{R as M}from"./DollarOutlined-CsSd3YX1.js";import{f as s,b as j}from"./money-DMHcC8uu.js";import{R as N}from"./RiseOutlined-BfYH29d9.js";import{F as o}from"./Table-pvERNZVb.js";import{s as x}from"./index-DBkC0DaV.js";import"./api-W_2ufh2E.js";import"./TextArea-Dl3y1VrD.js";import"./CalendarOutlined-6RDrkSku.js";import"./PurePanel-DcW2x34y.js";import"./Overflow-Gz7ZFAqv.js";import"./index-DfnzXlZl.js";import"./UnstableContext-DKFbPjPy.js";import"./SearchOutlined-CyHaylvE.js";import"./ClockCircleOutlined-DAoco557.js";import"./index-Do9OUhYv.js";import"./index-BoArUKpt.js";import"./useBreakpoint--6XYT0_e.js";import"./Skeleton-DdNqplha.js";import"./index-Dd1FzYQF.js";import"./Input-UrGHJeeK.js";import"./index-BndKrrhJ.js";import"./LeftOutlined-DGEyRIvL.js";import"./EllipsisOutlined-Bv641ndy.js";import"./Pagination-6AhiOKxV.js";import"./extendsObject-78o_rR5W.js";const{RangePicker:F}=E,{Title:V}=$,bt=()=>{const{theme:h}=b(),[u,p]=d.useState(!1),[C,g]=d.useState(!1),[r,v]=d.useState(null),[i,S]=d.useState(null),f=async()=>{p(!0);try{const e=i?{startDate:i[0].startOf("day").toISOString(),endDate:i[1].endOf("day").toISOString()}:void 0,a=await k(e);v(a)}catch(e){x.error("加载数据失败"),console.error(e)}finally{p(!1)}},R=async()=>{g(!0);try{const e=i?{startDate:i[0].startOf("day").toISOString(),endDate:i[1].endOf("day").toISOString()}:void 0;await O(e),x.success("导出成功")}catch(e){x.error("导出失败"),console.error(e)}finally{g(!1)}};d.useEffect(()=>{f()},[]);const I=[{title:"商务姓名",dataIndex:"staffName",key:"staffName",fixed:"left",width:120},{title:"邮箱",dataIndex:"staffEmail",key:"staffEmail",width:180,ellipsis:!0},{title:"建联数量",dataIndex:"contactedCount",key:"contactedCount",width:100,align:"right",sorter:(e,a)=>e.contactedCount-a.contactedCount},{title:"推进数量",dataIndex:"progressedCount",key:"progressedCount",width:100,align:"right",sorter:(e,a)=>e.progressedCount-a.progressedCount},{title:"成交数量",dataIndex:"closedCount",key:"closedCount",width:100,align:"right",sorter:(e,a)=>e.closedCount-a.closedCount},{title:"总GMV（元）",dataIndex:"totalGmv",key:"totalGmv",width:130,align:"right",sorter:(e,a)=>e.totalGmv-a.totalGmv,render:e=>`¥${s(e)}`},{title:"总成本（元）",dataIndex:"totalCost",key:"totalCost",width:130,align:"right",sorter:(e,a)=>e.totalCost-a.totalCost,render:e=>`¥${s(e)}`},{title:"平均ROI",dataIndex:"averageRoi",key:"averageRoi",width:100,align:"right",sorter:(e,a)=>e.averageRoi-a.averageRoi,render:e=>t.jsx("span",{style:{color:e>=1?"#52c41a":"#ff4d4f"},children:j(e)})},{title:"寄样数量",dataIndex:"dispatchCount",key:"dispatchCount",width:100,align:"right",sorter:(e,a)=>e.dispatchCount-a.dispatchCount},{title:"寄样成本（元）",dataIndex:"dispatchCost",key:"dispatchCost",width:130,align:"right",sorter:(e,a)=>e.dispatchCost-a.dispatchCost,render:e=>`¥${s(e)}`}];return t.jsxs("div",{style:{minHeight:"100vh",background:`linear-gradient(135deg, ${h.colors.background.secondary} 0%, ${h.colors.background.tertiary} 100%)`,position:"relative",padding:"24px",margin:"-24px"},children:[t.jsx("div",{style:{position:"absolute",top:"10%",left:"5%",width:"400px",height:"400px",background:"linear-gradient(135deg, rgba(90, 200, 250, 0.08), rgba(191, 90, 242, 0.08))",borderRadius:"50%",filter:"blur(80px)",pointerEvents:"none",zIndex:0}}),t.jsx("div",{style:{position:"absolute",top:"40%",right:"10%",width:"500px",height:"500px",background:"linear-gradient(135deg, rgba(255, 107, 107, 0.08), rgba(255, 217, 61, 0.08))",borderRadius:"50%",filter:"blur(100px)",pointerEvents:"none",zIndex:0}}),t.jsxs("div",{style:{position:"relative",zIndex:1},children:[t.jsx(V,{level:4,style:{marginBottom:24},children:"商务绩效报表"}),t.jsx(n,{variant:"elevated",style:{marginBottom:24},children:t.jsx(l,{children:t.jsxs(D,{size:"middle",wrap:!0,children:[t.jsx("span",{children:"时间范围："}),t.jsx(F,{value:i,onChange:e=>S(e),placeholder:["开始日期","结束日期"]}),t.jsx(y,{type:"primary",icon:t.jsx(G,{}),onClick:f,loading:u,children:"查询"}),t.jsx(y,{icon:t.jsx(P,{}),onClick:R,loading:C,children:"导出Excel"})]})})}),r&&t.jsxs(T,{gutter:16,style:{marginBottom:24},children:[t.jsx(m,{xs:24,sm:12,md:6,children:t.jsx(n,{variant:"elevated",hoverable:!0,children:t.jsx(l,{children:t.jsx(c,{title:"商务人数",value:r.summary.totalStaff,prefix:t.jsx(z,{}),suffix:"人"})})})}),t.jsx(m,{xs:24,sm:12,md:6,children:t.jsx(n,{variant:"elevated",hoverable:!0,children:t.jsx(l,{children:t.jsx(c,{title:"总成交数",value:r.summary.totalClosedCount,prefix:t.jsx(B,{}),suffix:"单"})})})}),t.jsx(m,{xs:24,sm:12,md:6,children:t.jsx(n,{variant:"elevated",hoverable:!0,children:t.jsx(l,{children:t.jsx(c,{title:"总GMV",value:Number(s(r.summary.totalGmv)),prefix:t.jsx(M,{}),suffix:"元",precision:2})})})}),t.jsx(m,{xs:24,sm:12,md:6,children:t.jsx(n,{variant:"elevated",hoverable:!0,children:t.jsx(l,{children:t.jsx(c,{title:"整体ROI",value:r.summary.overallRoi,prefix:t.jsx(N,{}),precision:2,valueStyle:{color:r.summary.overallRoi>=1?"#52c41a":"#ff4d4f"}})})})})]}),t.jsx(n,{variant:"elevated",children:t.jsx(l,{children:t.jsx(w,{spinning:u,children:t.jsx(o,{columns:I,dataSource:(r==null?void 0:r.items)||[],rowKey:"staffId",scroll:{x:1200},pagination:{showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条`},summary:()=>r?t.jsx(o.Summary,{fixed:!0,children:t.jsxs(o.Summary.Row,{children:[t.jsx(o.Summary.Cell,{index:0,children:t.jsx("strong",{children:"汇总"})}),t.jsx(o.Summary.Cell,{index:1}),t.jsx(o.Summary.Cell,{index:2,align:"right",children:t.jsx("strong",{children:r.summary.totalContactedCount})}),t.jsx(o.Summary.Cell,{index:3,align:"right",children:t.jsx("strong",{children:r.summary.totalProgressedCount})}),t.jsx(o.Summary.Cell,{index:4,align:"right",children:t.jsx("strong",{children:r.summary.totalClosedCount})}),t.jsx(o.Summary.Cell,{index:5,align:"right",children:t.jsxs("strong",{children:["¥",s(r.summary.totalGmv)]})}),t.jsx(o.Summary.Cell,{index:6,align:"right",children:t.jsxs("strong",{children:["¥",s(r.summary.totalCost)]})}),t.jsx(o.Summary.Cell,{index:7,align:"right",children:t.jsx("strong",{style:{color:r.summary.overallRoi>=1?"#52c41a":"#ff4d4f"},children:j(r.summary.overallRoi)})}),t.jsx(o.Summary.Cell,{index:8,align:"right",children:t.jsx("strong",{children:r.summary.totalDispatchCount})}),t.jsx(o.Summary.Cell,{index:9,align:"right",children:t.jsxs("strong",{children:["¥",s(r.summary.totalDispatchCost)]})})]})}):null})})})})]})]})};export{bt as default};

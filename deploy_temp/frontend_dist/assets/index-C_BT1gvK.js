import{ad as k,u as w,e as R,r as o,j as e,S}from"./index-CT9F3akh.js";import{h as z}from"./invitation.service-CM1HH-Kp.js";import{r as C}from"./auth.service-Azf4l4aS.js";import{F as s}from"./index-gbW5J2sR.js";import{R as E}from"./index-ColvUN_H.js";import{B as l}from"./button-BCSOJgfZ.js";import{C as $}from"./index-DSHlf2Aa.js";import{R as P}from"./TeamOutlined-Bai9oLhN.js";import{T as B}from"./index-WSGRBNKI.js";import{I as d}from"./index-htVVH06X.js";import{R as T}from"./UserOutlined-C5ACOCTv.js";import{R as N}from"./MobileOutlined-D0OPZNfE.js";import{R as h}from"./LockOutlined-DjHtpiEB.js";import{s as f}from"./index-DBkC0DaV.js";import"./api-W_2ufh2E.js";import"./TextArea-Dl3y1VrD.js";import"./Input-UrGHJeeK.js";import"./row-DVjUYxl3.js";import"./index-BoArUKpt.js";import"./useBreakpoint--6XYT0_e.js";import"./QuestionCircleOutlined-CZssou_a.js";import"./index-Do9OUhYv.js";import"./UnstableContext-DKFbPjPy.js";import"./Skeleton-DdNqplha.js";import"./index-DiUoGV2L.js";import"./EllipsisOutlined-Bv641ndy.js";import"./Overflow-Gz7ZFAqv.js";import"./PlusOutlined-oMbGAVrA.js";import"./SearchOutlined-CyHaylvE.js";const{Title:q,Text:F,Paragraph:H}=B,ge=()=>{const{code:a}=k(),n=w(),{theme:i}=R(),[y]=s.useForm(),[j,p]=o.useState(!0),[b,g]=o.useState(!1),[m,I]=o.useState(null),[u,c]=o.useState(null);o.useEffect(()=>{(async()=>{if(!a){c("邀请链接无效"),p(!1);return}try{const r=await z(a);r.status!=="PENDING"?c(r.status==="USED"?"该邀请链接已被使用":"该邀请链接已被撤销"):I(r)}catch(r){c(r.message||"邀请链接无效或已过期")}finally{p(!1)}})()},[a]);const v=async t=>{g(!0);try{await C({name:t.name,phone:t.phone,password:t.password,role:"BUSINESS",invitationCode:a}),f.success("注册成功！正在跳转..."),setTimeout(()=>{n("/login",{state:{message:"注册成功，请使用手机号和密码登录",phone:t.phone}})},1500)}catch(r){f.error(r.message||"注册失败，请重试")}finally{g(!1)}};return j?e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:`linear-gradient(135deg, ${i.colors.background.secondary} 0%, ${i.colors.background.tertiary} 100%)`},children:e.jsx(S,{size:"large",tip:"正在验证邀请链接..."})}):u||!m?e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:`linear-gradient(135deg, ${i.colors.background.secondary} 0%, ${i.colors.background.tertiary} 100%)`},children:e.jsx(E,{status:"error",title:"邀请链接无效",subTitle:u||"该邀请链接已过期或不存在",extra:[e.jsx(l,{type:"primary",onClick:()=>n("/login"),children:"前往登录"},"login"),e.jsx(l,{onClick:()=>n("/register"),children:"自行注册"},"register")]})}):e.jsxs("div",{style:{minHeight:"100vh",background:`linear-gradient(135deg, ${i.colors.background.secondary} 0%, ${i.colors.background.tertiary} 100%)`,padding:"40px 16px",display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx("div",{style:{position:"absolute",top:"10%",left:"5%",width:"400px",height:"400px",background:"linear-gradient(135deg, rgba(90, 200, 250, 0.08), rgba(191, 90, 242, 0.08))",borderRadius:"50%",filter:"blur(80px)",pointerEvents:"none",zIndex:0}}),e.jsx("div",{style:{position:"absolute",bottom:"10%",right:"5%",width:"500px",height:"500px",background:"linear-gradient(135deg, rgba(255, 107, 107, 0.08), rgba(255, 217, 61, 0.08))",borderRadius:"50%",filter:"blur(100px)",pointerEvents:"none",zIndex:0}}),e.jsxs($,{style:{maxWidth:440,width:"100%",borderRadius:8,boxShadow:"0 4px 24px rgba(0, 0, 0, 0.08)",position:"relative",zIndex:1},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:24},children:[e.jsx(P,{style:{fontSize:48,color:"#1890ff",marginBottom:16}}),e.jsxs(q,{level:3,style:{marginBottom:8},children:["加入 ",m.brandName]}),e.jsxs(H,{type:"secondary",children:[m.inviterName," 邀请您加入团队"]})]}),e.jsxs(s,{form:y,layout:"vertical",onFinish:v,children:[e.jsx(s.Item,{name:"name",label:"姓名",rules:[{required:!0,message:"请输入您的姓名"},{max:50,message:"姓名不能超过50个字符"}],children:e.jsx(d,{prefix:e.jsx(T,{}),placeholder:"请输入您的姓名",size:"large"})}),e.jsx(s.Item,{name:"phone",label:"手机号",rules:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确"}],children:e.jsx(d,{prefix:e.jsx(N,{}),placeholder:"请输入手机号（用于登录）",maxLength:11,size:"large"})}),e.jsx(s.Item,{name:"password",label:"设置密码",rules:[{required:!0,message:"请设置密码"},{min:6,message:"密码至少6个字符"}],children:e.jsx(d.Password,{prefix:e.jsx(h,{}),placeholder:"请设置登录密码（至少6个字符）",size:"large"})}),e.jsx(s.Item,{name:"confirmPassword",label:"确认密码",dependencies:["password"],rules:[{required:!0,message:"请再次输入密码"},({getFieldValue:t})=>({validator(r,x){return!x||t("password")===x?Promise.resolve():Promise.reject(new Error("两次输入的密码不一致"))}})],children:e.jsx(d.Password,{prefix:e.jsx(h,{}),placeholder:"请再次输入密码",size:"large"})}),e.jsx(s.Item,{style:{marginBottom:8},children:e.jsx(l,{type:"primary",htmlType:"submit",loading:b,block:!0,size:"large",children:"注册并加入团队"})}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(F,{type:"secondary",children:"已有账号？"}),e.jsx(l,{type:"link",onClick:()=>n("/login"),children:"直接登录"})]})]})]})]})};export{ge as default};

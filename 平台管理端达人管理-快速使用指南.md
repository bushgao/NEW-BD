# 平台管理端达人管理功能 - 快速使用指南

## 🚀 快速部署

### 第一步：运行数据库迁移

当数据库可用时，执行以下命令：

```bash
# 进入后端目录
cd packages/backend

# 运行数据库迁移
npx prisma migrate dev --name add_influencer_source_and_verification

# 生成 Prisma Client
npx prisma generate
```

**预期结果**：
- 创建新的迁移文件
- 数据库中添加7个新字段
- 现有达人自动获得默认值

### 第二步：重启服务

```bash
# 重启后端服务
cd packages/backend
npm run dev

# 重启前端服务（新终端）
cd packages/frontend
npm run dev
```

---

## 📖 功能使用指南

### 1. 访问平台管理页面

1. 使用**平台管理员账号**登录系统
2. 进入"平台管理"页面
3. 你会看到4个标签页：
   - **数据概览** - 新增的统计看板
   - **工厂管理** - 原有功能
   - **达人管理** - 新增功能 ⭐
   - **套餐配置** - 原有功能

### 2. 查看达人统计（数据概览）

**位置**：平台管理 → 数据概览

**功能**：
- 📊 达人总数、认证状态分布
- 📈 来源分布（平台/工厂/商务）
- 🌐 平台分布（抖音/小红书/快手等）
- 🏆 工厂达人排名（Top 10）
- 📉 来源质量分析（认证率、合作成功率）

**使用场景**：
- 了解平台整体达人情况
- 评估各来源渠道质量
- 发现优质工厂

### 3. 管理达人（达人管理）

**位置**：平台管理 → 达人管理

#### 3.1 查看达人列表

**功能**：
- 显示所有工厂的达人
- 每个达人显示：昵称、平台、粉丝数、工厂、来源、认证状态、添加人、添加时间

**筛选功能**：
- 🔍 搜索：昵称/账号ID/手机号
- 📱 平台：抖音/小红书/快手/微博/其他
- 🏢 来源类型：平台添加/工厂添加/商务添加
- ✅ 认证状态：未认证/已认证/认证失败

**操作**：
- 👁️ 查看详情：点击"查看"图标
- ✅ 认证：点击"认证"按钮（仅未认证达人）
- 📥 导出：点击"导出"按钮，下载Excel文件

#### 3.2 查看达人详情

**点击"查看"图标后，弹出详情窗口，包含4个标签页：**

**① 基本信息**
- 昵称、平台、账号ID
- 粉丝数、手机号、微信号
- 类目、标签、备注

**② 来源信息**
- 来源类型（平台/工厂/商务）
- 添加人姓名和角色
- 添加时间
- 所属工厂和工厂老板

**③ 认证信息**
- 当前认证状态
- 认证时间和认证人
- 认证备注
- 📜 认证历史时间线（完整记录）

**④ 合作记录**
- 历史合作列表
- 合作阶段、商务人员
- 创建时间、是否有结果

#### 3.3 认证达人

**操作步骤**：

1. **找到未认证达人**
   - 在达人列表中，认证状态显示"未认证"的达人
   - 或使用筛选器：认证状态 = 未认证

2. **点击"认证"按钮**
   - 弹出认证审核窗口

3. **审核达人信息**
   - 查看达人的详细资料
   - 核实昵称、平台、账号ID、粉丝数
   - 查看联系方式、添加人信息

4. **选择审核结果**
   - ✅ **通过认证**：信息真实可靠
   - ❌ **拒绝认证**：信息有问题（必须填写原因）

5. **填写备注**
   - 通过时：可选填写备注
   - 拒绝时：必须填写拒绝原因

6. **提交审核**
   - 点击"提交"按钮
   - 系统自动：
     - 更新认证状态
     - 记录认证历史
     - 发送通知给工厂老板
     - 发送通知给添加人

**认证后效果**：
- 达人状态变为"已认证"或"认证失败"
- 工厂老板收到通知
- 添加人收到通知
- 认证历史完整记录

#### 3.4 导出达人数据

**操作步骤**：

1. **设置筛选条件**（可选）
   - 选择平台、来源类型、认证状态等

2. **点击"导出"按钮**
   - 系统生成Excel文件
   - 自动下载到本地

**Excel包含字段**：
- 昵称、平台、账号ID
- 粉丝数、手机号、微信号
- 所属工厂、来源类型、添加人
- 认证状态、认证时间
- 合作次数、添加时间

---

## 🎯 典型使用场景

### 场景1：每日达人审核

**目标**：审核新添加的达人

**步骤**：
1. 进入"达人管理"
2. 筛选：认证状态 = 未认证
3. 逐个查看达人信息
4. 点击"认证"按钮进行审核
5. 通过或拒绝，填写备注

**频率**：每天1次

### 场景2：评估来源渠道质量

**目标**：了解哪个渠道的达人质量最好

**步骤**：
1. 进入"数据概览"
2. 查看"来源质量分析"表格
3. 对比各渠道的：
   - 认证率（越高越好）
   - 合作成功率（越高越好）
4. 根据数据优化达人获取策略

**频率**：每周1次

### 场景3：查找优质工厂

**目标**：找到达人数量多的工厂

**步骤**：
1. 进入"数据概览"
2. 查看"工厂达人排名（Top 10）"
3. 记录排名靠前的工厂
4. 可以给予奖励或重点关注

**频率**：每月1次

### 场景4：导出达人报表

**目标**：生成月度达人报表

**步骤**：
1. 进入"达人管理"
2. 不设置筛选（导出全部）
3. 或设置筛选（导出特定条件）
4. 点击"导出"按钮
5. 打开Excel文件进行分析

**频率**：每月1次

---

## 🔍 功能验证清单

部署后，请按以下清单验证功能：

### ✅ 基础功能

- [ ] 能访问"平台管理"页面
- [ ] 能看到"数据概览"标签页
- [ ] 能看到"达人管理"标签页
- [ ] 统计数据正确显示

### ✅ 达人列表

- [ ] 能看到所有工厂的达人
- [ ] 能看到来源标识（平台/工厂/商务）
- [ ] 能看到认证状态（未认证/已认证/认证失败）
- [ ] 能看到添加人信息
- [ ] 搜索功能正常
- [ ] 筛选功能正常
- [ ] 分页功能正常

### ✅ 达人详情

- [ ] 点击"查看"能打开详情窗口
- [ ] 4个标签页都能正常显示
- [ ] 基本信息完整
- [ ] 来源信息准确
- [ ] 认证信息正确
- [ ] 合作记录显示

### ✅ 达人认证

- [ ] 点击"认证"能打开认证窗口
- [ ] 达人信息显示完整
- [ ] 能选择通过/拒绝
- [ ] 拒绝时必须填写原因
- [ ] 提交后状态更新
- [ ] 工厂老板收到通知
- [ ] 添加人收到通知
- [ ] 认证历史正确记录

### ✅ 数据统计

- [ ] 达人总数正确
- [ ] 认证状态分布正确
- [ ] 来源分布正确
- [ ] 平台分布正确
- [ ] 工厂排名正确
- [ ] 质量分析数据准确

### ✅ 导出功能

- [ ] 点击"导出"能下载Excel
- [ ] Excel包含所有字段
- [ ] 数据准确无误
- [ ] 筛选条件生效

### ✅ 来源追踪

- [ ] 创建新达人时自动记录添加人
- [ ] 来源类型自动判断正确
- [ ] 平台管理员添加 → 来源类型 = 平台添加
- [ ] 工厂老板添加 → 来源类型 = 工厂添加
- [ ] 商务人员添加 → 来源类型 = 商务添加

---

## 🐛 常见问题

### Q1: 看不到"达人管理"标签页？

**原因**：不是平台管理员账号

**解决**：
- 确认使用的是 `PLATFORM_ADMIN` 角色的账号
- 普通用户和工厂用户无法访问

### Q2: 现有达人的来源信息为空？

**原因**：迁移前添加的达人没有来源信息

**解决**：
- 这是正常的，迁移前的达人 `createdBy` 为 null
- 来源类型默认为 `STAFF`
- 新添加的达人会自动记录来源

### Q3: 认证后工厂老板没收到通知？

**原因**：通知系统可能有问题

**检查**：
1. 查看数据库 `Notification` 表
2. 确认通知记录已创建
3. 检查前端通知组件是否正常

### Q4: 导出功能报错？

**原因**：可能缺少 ExcelJS 依赖

**解决**：
```bash
cd packages/backend
npm install exceljs
```

### Q5: 统计数据不准确？

**原因**：数据库数据可能有问题

**检查**：
1. 查看数据库中的达人数据
2. 确认字段值正确
3. 重新计算统计数据

---

## 📊 数据示例

### 来源分布示例

```
平台添加: 50 个 (10%)
工厂添加: 150 个 (30%)
商务添加: 300 个 (60%)
```

### 认证状态示例

```
未认证: 200 个 (40%)
已认证: 280 个 (56%)
认证失败: 20 个 (4%)
```

### 来源质量分析示例

| 来源类型 | 总数 | 已认证 | 认证率 | 合作数 | 成功率 |
|---------|------|--------|--------|--------|--------|
| 平台添加 | 50   | 45     | 90%    | 120    | 85%    |
| 工厂添加 | 150  | 90     | 60%    | 200    | 70%    |
| 商务添加 | 300  | 145    | 48%    | 450    | 65%    |

**分析**：
- 平台添加的达人质量最高（认证率90%，成功率85%）
- 商务添加的达人数量最多，但质量相对较低
- 建议：加强商务人员培训，提高达人质量

---

## 🎓 最佳实践

### 1. 定期审核

- **每天**审核新添加的达人
- **每周**查看统计数据
- **每月**导出报表分析

### 2. 认证标准

建议的认证标准：
- ✅ 粉丝数真实（可通过平台验证）
- ✅ 联系方式有效（可以联系到）
- ✅ 账号活跃（近期有发布内容）
- ❌ 粉丝数虚假（明显刷粉）
- ❌ 联系方式无效（无法联系）
- ❌ 账号异常（被封禁、长期不活跃）

### 3. 备注规范

**通过认证时**：
- "信息真实，粉丝活跃"
- "已核实联系方式"
- "优质达人，推荐合作"

**拒绝认证时**：
- "粉丝数与平台显示不符"
- "联系方式无效，无法联系"
- "账号已被封禁"
- "长期不活跃，最后发布时间：2023-01-01"

### 4. 数据分析

定期分析以下指标：
- 各来源渠道的认证率
- 各来源渠道的合作成功率
- 各工厂的达人数量和质量
- 各平台的达人分布

根据数据优化：
- 达人获取策略
- 商务人员培训
- 工厂激励政策

---

## 📞 技术支持

如遇到问题，请查看：
- `平台管理端达人管理功能完成报告.md` - 详细技术文档
- `平台管理端功能-实施进度.md` - 实施进度
- `本次工作总结.md` - 工作总结

或联系技术团队获取支持。

---

**文档版本**: v1.0  
**最后更新**: 2026年1月6日  
**适用版本**: 平台管理端功能增强 v1.0

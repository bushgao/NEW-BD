# 微信一键添加好友 - 使用指南

## 📦 安装步骤

### 1. 安装 Python 环境
确保已安装 Python 3.8+，可从 [python.org](https://www.python.org/downloads/) 下载。

### 2. 安装本地桥接程序
```bash
# 进入 native-host 目录
cd native-host

# 运行安装脚本（管理员权限）
install.bat
```

安装脚本会自动：
- 安装 Python 依赖
- 生成 Native Host 配置
- 注册到 Chrome 浏览器

### 3. 加载 Chrome 插件
1. 打开 Chrome，访问 `chrome://extensions/`
2. 开启"开发者模式"
3. 点击"加载已解压的扩展程序"
4. 选择 `chrome-extension` 目录

---

## 🎯 功能使用

### 话术管理
1. 登录系统，进入 **话术管理** 页面
2. 创建话术模板，支持变量：
   - `{达人昵称}` - 达人名称
   - `{产品名}` - 关联产品
   - `{品牌名}` - 品牌名称
   - `{当前日期}` - 当前日期
   - `{微信号}` - 目标微信号

### 批量添加
1. 进入 **达人库** 页面
2. 勾选多个达人
3. 点击 **批量操作** → **批量添加微信**
4. 选择话术模板，设置间隔时间
5. 点击"开始"执行批量添加

### 状态查看
- 达人列表的"微信状态"列显示添加状态
- 点击达人详情可查看完整微信联系状态

---

## ⚠️ 注意事项

1. **确保微信已登录**：PC 版微信需保持登录状态
2. **间隔时间**：建议 30 秒以上，避免触发风控
3. **手动确认**：添加操作需在微信端手动确认发送
4. **多实例**：如运行多个微信，系统会自动检测可用窗口

---

## 🔧 故障排除

| 问题 | 解决方案 |
|------|----------|
| 插件无法连接 | 重新运行 `install.bat`，重启 Chrome |
| 找不到微信窗口 | 确保微信已登录且窗口未最小化 |
| 中文输入失败 | 检查系统剪贴板功能正常 |
| 添加失败 | 检查目标微信号是否正确 |

---

## 📁 文件结构

```
native-host/
├── wechat_bridge.py      # 主程序
├── wechat_automation.py  # 微信自动化
├── native_messaging.py   # Chrome 通信
├── install.bat           # 安装脚本
├── uninstall.bat         # 卸载脚本
└── requirements.txt      # Python 依赖
```

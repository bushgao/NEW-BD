# 快速启动指南

## 🚀 5分钟启动系统

### 前置要求

确保您的系统已安装：
- **Node.js** (v18 或更高版本)
- **PostgreSQL** (v14 或更高版本)
- **npm** 或 **yarn**

---

## 步骤 1：安装依赖

在项目根目录执行：

```bash
npm install
```

这将安装所有 packages 的依赖。

---

## 步骤 2：配置数据库

### 2.1 创建数据库

在 PostgreSQL 中创建数据库：

```sql
CREATE DATABASE influencer_collab;
```

### 2.2 配置环境变量

复制后端的环境变量模板：

```bash
cd packages/backend
copy .env.example .env
```

编辑 `.env` 文件，确保数据库连接信息正确：

```env
DATABASE_URL="postgresql://postgres:你的密码@localhost:5432/influencer_collab?schema=public"
```

---

## 步骤 3：初始化数据库

在 `packages/backend` 目录下执行：

```bash
# 生成 Prisma Client
npm run db:generate

# 运行数据库迁移
npm run db:migrate

# 填充测试数据
npm run db:seed
```

---

## 步骤 4：启动后端服务

在 `packages/backend` 目录下执行：

```bash
npm run dev
```

后端将运行在 `http://localhost:3000`

看到以下信息表示启动成功：
```
Server is running on port 3000
Database connected successfully
```

---

## 步骤 5：启动前端服务

**打开新的终端窗口**，在 `packages/frontend` 目录下执行：

```bash
npm run dev
```

前端将运行在 `http://localhost:5173`

看到以下信息表示启动成功：
```
VITE v5.x.x  ready in xxx ms

➜  Local:   http://localhost:5173/
➜  Network: use --host to expose
```

---

## 步骤 6：访问系统

在浏览器中打开：`http://localhost:5173`

### 测试账号

根据 seed 数据，您可以使用以下账号登录：

| 角色 | 邮箱 | 密码 | 权限 |
|------|------|------|------|
| 平台管理员 | admin@example.com | password123 | 工厂管理、账号管理、收费管理 |
| 工厂老板 | owner@example.com | password123 | 样品管理、成本看板、ROI报表 |
| 商务人员 | staff@example.com | password123 | 达人管理、跟进管道、寄样操作 |

> 注意：请查看 `packages/backend/prisma/seed.ts` 确认实际的测试账号和密码

---

## 🔧 常见问题

### 问题 1：数据库连接失败

**错误信息**：
```
Error: Can't reach database server at `localhost:5432`
```

**解决方案**：
1. 确保 PostgreSQL 服务正在运行
2. 检查 `.env` 文件中的数据库连接信息是否正确
3. 确认数据库 `influencer_collab` 已创建

### 问题 2：端口被占用

**错误信息**：
```
Error: listen EADDRINUSE: address already in use :::3000
```

**解决方案**：
1. 关闭占用端口的程序
2. 或修改 `.env` 文件中的 `PORT` 配置

### 问题 3：Prisma Client 未生成

**错误信息**：
```
Error: @prisma/client did not initialize yet
```

**解决方案**：
```bash
cd packages/backend
npm run db:generate
```

### 问题 4：前端无法连接后端

**错误信息**：
```
Network Error
```

**解决方案**：
1. 确保后端服务正在运行（`http://localhost:3000`）
2. 检查浏览器控制台的网络请求
3. 确认 CORS 配置正确

---

## 📊 验证系统运行

### 1. 检查后端 API

在浏览器或 Postman 中访问：
```
http://localhost:3000/api/health
```

应该返回：
```json
{
  "status": "ok",
  "timestamp": "2025-01-05T..."
}
```

### 2. 检查前端页面

访问 `http://localhost:5173`，应该看到登录页面。

### 3. 测试登录

使用测试账号登录，验证系统功能。

---

## 🛠️ 开发工具

### Prisma Studio（数据库可视化工具）

```bash
cd packages/backend
npm run db:studio
```

这将打开 Prisma Studio，可以直接查看和编辑数据库数据。

### 运行测试

```bash
cd packages/backend
npm run test
```

---

## 📝 下一步

系统启动成功后，您可以：

1. 📖 阅读 [测试指南](./测试指南.md) 进行功能测试
2. 📋 查看 [项目整理总结](./项目整理总结.md) 了解项目现状
3. 🚀 开始开发新功能或修复 bug

---

## 🆘 需要帮助？

如果遇到问题：
1. 查看控制台错误信息
2. 检查 `packages/backend/logs` 目录下的日志文件
3. 查看 [常见问题](#常见问题) 部分
4. 联系开发团队

---

## 🎉 恭喜！

您已成功启动系统，现在可以开始测试和开发了！

# 系统测试指南

## 📋 测试前准备

### 1. 启动开发环境

#### 后端启动
```bash
cd packages/backend
npm run dev
```
后端将运行在 `http://localhost:3000`

#### 前端启动
```bash
cd packages/frontend
npm run dev
```
前端将运行在 `http://localhost:5173`

#### 数据库准备
```bash
cd packages/backend
npm run db:generate  # 生成 Prisma Client
npm run db:migrate   # 运行数据库迁移
npm run db:seed      # 填充测试数据
```

### 2. 测试账号

根据 seed 数据，系统应该有以下测试账号：

- **平台管理员**: admin@example.com
- **工厂老板**: owner@example.com
- **商务人员**: staff@example.com

密码通常为：`password123`（请查看 `packages/backend/prisma/seed.ts` 确认）

---

## 🧪 功能测试清单

### 模块 1：用户认证与角色权限

#### 测试点：
- [ ] 1.1 用户登录
  - 使用正确的邮箱和密码登录
  - 使用错误的密码登录（应该失败）
  - 使用不存在的邮箱登录（应该失败）

- [ ] 1.2 角色权限
  - 平台管理员登录后，应该看到工厂管理、账号管理等功能
  - 工厂老板登录后，应该看到样品管理、成本看板、ROI报表等功能
  - 商务人员登录后，应该看到达人管理、跟进管道、寄样操作等功能

- [ ] 1.3 权限控制
  - 商务人员尝试访问工厂老板的功能（应该被拒绝）
  - 未登录用户访问系统（应该跳转到登录页）

---

### 模块 2：达人信息管理

#### 测试点：
- [ ] 2.1 添加达人
  - 填写达人基础信息（昵称、平台、账号ID、联系方式）
  - 添加类目标签
  - 保存成功后应该在达人列表中看到

- [ ] 2.2 导入达人
  - 准备一个 Excel 文件（包含达人信息）
  - 上传并导入
  - 检查导入结果（成功/失败/重复）

- [ ] 2.3 去重检测
  - 尝试添加相同手机号的达人（应该提示重复）
  - 尝试添加相同平台账号ID的达人（应该提示重复）

- [ ] 2.4 编辑达人
  - 修改达人信息
  - 查看变更历史

- [ ] 2.5 搜索和筛选
  - 按昵称搜索
  - 按类目筛选
  - 按合作状态筛选
  - 按标签筛选

- [ ] 2.6 自定义标签
  - 为达人添加标签（如：高配合度、价格敏感）
  - 删除标签

---

### 模块 3：样品与成本管理

#### 测试点：
- [ ] 3.1 添加样品
  - 填写样品信息（SKU、名称、单件成本、建议零售价）
  - 设置是否可复寄
  - 保存成功

- [ ] 3.2 编辑样品成本
  - 修改样品成本
  - 系统应该保留历史成本记录

- [ ] 3.3 创建寄样记录
  - 选择样品
  - 选择达人
  - 填写寄样数量
  - 系统自动计算寄样总成本（数量 × 单件成本）

- [ ] 3.4 填写快递费用
  - 填写快递单号
  - 填写快递费用
  - 系统自动计算总成本（样品成本 + 快递成本）

- [ ] 3.5 更新签收状态
  - 标记为"已签收"
  - 记录签收时间

- [ ] 3.6 更新上车状态
  - 标记为"已上车"或"未上车"

- [ ] 3.7 查看样品成本报表
  - 查看各样品的累计寄样数量
  - 查看累计成本
  - 查看签收率
  - 查看上车率

---

### 模块 4：合作流程管道

#### 测试点：
- [ ] 4.1 查看管道看板
  - 应该看到各阶段的达人卡片
  - 阶段包括：线索达人 → 已联系 → 已报价 → 已寄样 → 已排期 → 已发布 → 已复盘

- [ ] 4.2 拖动卡片
  - 将达人卡片拖动到下一阶段
  - 系统应该更新合作状态
  - 记录状态变更时间

- [ ] 4.3 设置截止时间
  - 为合作设置截止时间
  - 保存成功

- [ ] 4.4 超期提醒
  - 合作超过截止时间后，应该自动标记为"超期"
  - 在看板上高亮显示

- [ ] 4.5 记录跟进备注
  - 添加跟进备注
  - 查看备注历史

- [ ] 4.6 标记卡点原因
  - 选择预设原因（报价太贵、达人拖延、不配合）
  - 或自定义原因

---

### 模块 5：合作结果与 ROI 计算

#### 测试点：
- [ ] 5.1 录入合作结果
  - 选择内容形式（短视频/直播）
  - 填写发布时间
  - 填写销售件数
  - 填写销售GMV
  - 填写佣金比例
  - 填写坑位费
  - 填写实付佣金

- [ ] 5.2 自动计算合作总成本
  - 系统应该自动计算：样品成本 + 快递成本 + 坑位费 + 实付佣金

- [ ] 5.3 自动计算 ROI
  - 系统应该自动计算：销售GMV / 合作总成本

- [ ] 5.4 自动判断回本状态
  - ROI < 1：未回本
  - ROI >= 1：已回本
  - ROI >= 3：爆赚

- [ ] 5.5 查看 ROI 报表
  - 按达人汇总
  - 按样品汇总
  - 按商务汇总
  - 按时间段汇总

- [ ] 5.6 标记复投意向
  - 标记是否复投
  - 在达人档案中显示

---

### 模块 6：商务绩效统计

#### 测试点：
- [ ] 6.1 查看商务绩效
  - 查看每个商务的建联数量
  - 查看推进数量
  - 查看成交数量

- [ ] 6.2 查看合作数据
  - 查看每个商务负责的合作总GMV
  - 查看总成本
  - 查看平均ROI

- [ ] 6.3 查看寄样数据
  - 查看每个商务的寄样数量
  - 查看寄样成本

- [ ] 6.4 时间范围筛选
  - 选择时间范围
  - 按所选时间段筛选绩效数据

- [ ] 6.5 导出绩效报表
  - 导出为 Excel 格式

---

### 模块 7：工厂老板看板

#### 测试点：
- [ ] 7.1 查看关键指标卡片
  - 本月/本周的总寄样成本
  - 总合作成本
  - 总GMV
  - 整体ROI

- [ ] 7.2 查看管道分布
  - 各阶段的数量分布

- [ ] 7.3 查看待跟进事项
  - 超期合作
  - 待签收样品
  - 待录入结果

- [ ] 7.4 查看商务人效排行
  - 按成交数量排序
  - 按GMV排序

- [ ] 7.5 点击指标卡片
  - 应该跳转到对应的详情页面

---

### 模块 8：平台管理功能

#### 测试点：
- [ ] 8.1 工厂入驻审核
  - 查看待审核的工厂申请
  - 批准或拒绝申请

- [ ] 8.2 设置工厂套餐
  - 设置商务账号数量限制
  - 设置达人数量上限
  - 设置数据保留周期

- [ ] 8.3 套餐限制
  - 工厂达到套餐限制后，应该提示升级套餐
  - 限制新增操作

- [ ] 8.4 查看平台数据
  - 入驻工厂数量
  - 活跃用户数
  - 总合作数量

- [ ] 8.5 管理套餐配置
  - 创建新套餐
  - 编辑套餐（免费版、专业版、企业版）

---

### 模块 9：数据导入导出

#### 测试点：
- [ ] 9.1 上传 Excel 文件
  - 选择文件
  - 上传成功

- [ ] 9.2 预览导入数据
  - 查看待导入的数据
  - 显示字段映射界面

- [ ] 9.3 字段映射
  - 匹配系统字段
  - 保存映射

- [ ] 9.4 确认导入
  - 执行导入
  - 查看导入结果（成功/失败/重复的记录数量）

- [ ] 9.5 导出数据
  - 导出达人列表
  - 导出寄样记录
  - 导出合作结果
  - 导出 ROI 报表
  - 格式为 Excel

- [ ] 9.6 错误处理
  - 导入格式错误的文件
  - 应该提示具体错误位置和原因

---

### 模块 10：提醒与通知

#### 测试点：
- [ ] 10.1 截止时间提醒
  - 合作即将到达截止时间（提前1天）
  - 应该向负责商务发送提醒通知

- [ ] 10.2 超期提醒
  - 合作超过截止时间未推进
  - 应该向负责商务和工厂老板发送超期提醒

- [ ] 10.3 签收提醒
  - 样品寄出超过7天未签收
  - 应该向负责商务发送提醒

- [ ] 10.4 结果录入提醒
  - 达人已上车但超过14天未录入结果
  - 应该向负责商务发送提醒

- [ ] 10.5 通知中心
  - 登录系统后，查看通知中心
  - 应该显示未读提醒列表

---

### 模块 11：达人端口（如果已实现）

#### 测试点：
- [ ] 11.1 达人登录
  - 使用手机号+验证码登录
  - 首次登录自动创建账号

- [ ] 11.2 查看样品总览
  - 查看总数量
  - 查看各状态数量

- [ ] 11.3 查看样品列表
  - 按工厂分组显示
  - 查看样品详情（名称、来源工厂、寄出时间、快递单号、状态）

- [ ] 11.4 筛选样品
  - 按工厂筛选
  - 按状态筛选
  - 按时间范围筛选

- [ ] 11.5 查看快递信息
  - 样品状态为"已寄出"时，显示快递信息

- [ ] 11.6 确认签收
  - 点击"确认签收"按钮
  - 更新样品状态为"已签收"
  - 同步更新工厂端的寄样记录

- [ ] 11.7 查看合作进度
  - 查看所有进行中的合作记录
  - 查看合作详情（工厂名称、合作阶段、关联样品、截止时间）

- [ ] 11.8 数据隔离
  - 达人只能看到与自己相关的数据
  - 不能看到其他达人的信息
  - 不能看到工厂的成本、ROI等敏感信息

---

## 🐛 已知问题记录

在测试过程中发现的问题，请记录在这里：

### 问题 1
- **模块**: 
- **描述**: 
- **重现步骤**: 
- **预期结果**: 
- **实际结果**: 
- **优先级**: 高/中/低

---

## 📊 测试结果汇总

### 通过的测试
- [ ] 模块 1：用户认证与角色权限
- [ ] 模块 2：达人信息管理
- [ ] 模块 3：样品与成本管理
- [ ] 模块 4：合作流程管道
- [ ] 模块 5：合作结果与 ROI 计算
- [ ] 模块 6：商务绩效统计
- [ ] 模块 7：工厂老板看板
- [ ] 模块 8：平台管理功能
- [ ] 模块 9：数据导入导出
- [ ] 模块 10：提醒与通知
- [ ] 模块 11：达人端口

### 测试覆盖率
- 总测试点数：
- 已测试：
- 通过：
- 失败：
- 覆盖率：%

---

## 🔧 测试工具

### 后端 API 测试
可以使用以下工具测试后端 API：
- **Postman**: 导入 API 集合进行测试
- **curl**: 命令行测试
- **Jest**: 运行单元测试 `npm run test`

### 前端测试
- **浏览器开发者工具**: 查看网络请求、控制台错误
- **React DevTools**: 查看组件状态

### 数据库查看
```bash
cd packages/backend
npm run db:studio
```
这将打开 Prisma Studio，可以直接查看和编辑数据库数据。

---

## 📝 测试注意事项

1. **测试数据隔离**: 使用测试账号进行测试，避免影响生产数据
2. **清理测试数据**: 测试完成后，清理测试数据或重置数据库
3. **记录问题**: 发现问题及时记录，包括重现步骤和截图
4. **跨浏览器测试**: 在不同浏览器（Chrome、Firefox、Safari）中测试
5. **响应式测试**: 在不同设备尺寸下测试（桌面、平板、手机）

---

## 🚀 下一步

测试完成后，根据测试结果：
1. 修复发现的 bug
2. 优化用户体验
3. 补充缺失的功能
4. 准备部署到生产环境
